sudo vi /etc/netplan/10-lxc.yaml

network:
 version: 2
   Ethernets:
     eth0:
      dhcp4: true
      dhcp-identifier: mac
      addresses: [10.11.35.162/28] --> A remplacer par l'addresse IP souhaité
      routes:
        - to: default
          via: 10.11.35.174 --> A remplacer par l'addresse IP de la passerelle
      nameservers:
        addresses: [1.1.1.3]

Sur vi : i --> Pour être en mode insertion
echap --> Pour quitter le mode insertion
:wq --> Sauvegarder et quitter

Pour configurer le DHCP allez dans /etc/udhcpd.conf
# Définir la plage d'adresses IP à attribuer
start   192.168.10.2    # Première adresse IP de la plage DHCP
end     192.168.10.14   # Dernière adresse IP de la plage DHCP

# Interface réseau sur laquelle le serveur DHCP écoute
interface ens33         # Remplacez par le nom de votre interface réseau

# Masque de sous-réseau
option  subnet  255.255.255.240

# Passerelle par défaut
opt     router  192.168.10.1    # Remplacez par l'adresse IP de votre passerelle

# Serveurs DNS
opt     dns     192.168.10.2 192.168.10.10  # Remplacez par les adresses DNS de votre réseau
option  dns     129.219.13.81               # DNS supplémentaire

# Domaine local
option  domain  local

# Durée du bail DHCP (en secondes)
option  lease   864000          # 10 jours

# Fichier de boot PXE (pour le démarrage réseau)
opt     bootfile /amd64/pxelinux.0  # Chemin du fichier de boot sur le serveur TFTP

# Adresse IP du serveur TFTP
siaddr  192.168.10.2    # Remplacez par l'adresse IP de votre serveur TFTP

# Options supplémentaires (facultatives)
opt     wins    192.168.10.10   # Serveur WINS (si utilisé)
option  msstaticroutes  10.0.0.0/8 10.127.0.1           # Route statique
option  staticroutes    10.0.0.0/8 10.127.0.1, 10.11.12.0/24 10.11.12.1
option  0x08    01020304        # Option personnalisée en hexadécimal
option  14      "dumpfile"      # Option personnalisée en chaîne de caractères

Appliquer la configuration et redémarrer le service

sudo systemctl restart udhcpd
sudo systemctl enable udhcpd
sudo systemctl status udhcpd

Pas eu besoin de configurer le serveur tftpd la config existante était déjà suffisante

sudo systemctl restart tftpd-hpa

Ajout d'ArchLinux en tant que boot

sudo apt install syslinux -y
sudo cp /usr/lib/syslinux/modules/bios/* /srv/tftp/amd64/
sudo wget https://archlinux.org/static/netboot/jpxe-arch.5ee66f360339.pxe -P /srv/tftp/amd64

Configuration du menu PXE : 
sudo nano /srv/tftp/amd64/pxelinux.cfg/default

DEFAULT menu.c32
PROMPT 0
MENU TITLE PXE Boot Menu

LABEL Ubuntu
  MENU LABEL Live Ubuntu
  KERNEL /amd64/ubuntu-installer/amd64/linux
  APPEND initrd=/amd64/ubuntu-installer/amd64/initrd.gz

LABEL Arch
  MENU LABEL Live Arch Linux
  KERNEL /amd64/jpxe-arch.5ee66f360339.pxe

sudo systemctl enable udhcpd
sudo systemctl enable tftp-hpa

sudo reboot


      
       
      